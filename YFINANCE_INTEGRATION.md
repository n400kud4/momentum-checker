# yfinance統合計画

## 🎯 目標
サンプルデータから実際のyfinanceデータ取得への移行

## 📋 現在の状況
- ✅ 完全なUI実装完了
- ✅ サンプルデータでの動作確認
- ✅ 期間変更機能実装
- ✅ iPhone対応完了

## 🚀 統合計画

### Phase 1: 基本データ取得機能
- [ ] yfinanceライブラリの段階的追加
- [ ] 単一ETFでのテスト（IEFから開始）
- [ ] エラーハンドリング実装
- [ ] キャッシュ機能実装

### Phase 2: モメンタム計算
- [ ] IEF 1ヶ月リターン計算
- [ ] リアルタイム推奨銘柄判定
- [ ] サンプルデータとの比較テスト

### Phase 3: 完全バックテスト
- [ ] TQQQ・GLDデータ統合
- [ ] 3ヶ月リバランス計算
- [ ] 履歴データでのバックテスト
- [ ] パフォーマンス統計の更新

### Phase 4: 本番デプロイ
- [ ] Streamlit Cloud での動作確認
- [ ] エラー処理の最終調整
- [ ] パフォーマンス最適化

## 🔧 技術的考慮事項

### データ取得の課題
- **レート制限**: APIコール回数制限
- **タイムアウト**: ネットワーク接続問題
- **データ品質**: 欠損データの処理

### 解決策
- **キャッシュ**: st.cache_data でAPI呼び出し削減
- **リトライ**: 自動再試行メカニズム
- **フォールバック**: サンプルデータへの切り替え

## 📅 利用可能データ期間

| ETF | 開始日 | 制限事項 |
|-----|--------|----------|
| IEF | 2004年 | なし |
| GLD | 2004年 | なし |
| TQQQ | 2010年3月 | **制限あり** |

**実装後の利用可能期間**: 2010年3月 ～ 現在

## 🧪 テスト戦略

### 段階的テスト
1. **ローカル環境**: 基本動作確認
2. **サンプル比較**: 計算結果の整合性
3. **Streamlit Cloud**: 本番環境での動作
4. **iPhone確認**: モバイル環境での動作

### エラーケース
- ネットワーク接続失敗
- データ取得タイムアウト
- 不正な日付範囲
- ETFデータ欠損

## 🔄 ブランチ戦略

- **main**: 安定版（サンプルデータ）
- **feature/yfinance-integration**: 開発版（yfinance統合）
- **マージ条件**: 完全動作確認後

## 📈 期待される改善

### 機能面
- **2010年～現在**: 14年分の実データ
- **自動更新**: 毎日最新データ
- **正確性**: 実際の市場価格

### ユーザー体験
- **リアルタイム**: 最新の推奨銘柄
- **幅広い期間**: 長期バックテスト可能
- **信頼性**: 実際のデータに基づく分析

---

*このブランチでyfinance統合を段階的に実装します*